{% extends "base.html" %}

{% block content %}
<h2>{{ 'Edit Appointment' if appointment else 'New Appointment' }}</h2>

<form method="post">
  <div class="mb-3">
    <label class="form-label">Client</label>
    <select name="client_id" class="form-select" required>
      <option value="">-- select client --</option>
      {% for c in clients %}
        <option value="{{ c.client_id }}"
          {% if appointment and appointment.client_id == c.client_id %}selected{% endif %}>
          {{ c.first_name }} {{ c.last_name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-3">
    <label class="form-label">Service</label>
    <select name="service_id" class="form-select" required>
      <option value="">-- select service --</option>
      {% for s in services %}
        <option value="{{ s.service_id }}"
          {% if appointment and appointment.service_id == s.service_id %}selected{% endif %}>
          {{ s.service_name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-3">
    <label class="form-label">Start</label>
    <input name="start_time" type="datetime-local" class="form-control"
           value="{{ appointment.start_time[:16]|replace(' ', 'T') if appointment and appointment.start_time else '' }}" required>
  </div>

  <div class="mb-3">
    <label class="form-label">End</label>
    <input name="end_time" type="datetime-local" class="form-control"
           value="{{ appointment.end_time[:16]|replace(' ', 'T') if appointment and appointment.end_time else '' }}">
    <div class="form-text">Use local date/time (YYYY-MM-DD HH:MM). End is optional.</div>
  </div>

  <div class="mb-3">
    <label class="form-label">Notes</label>
    <textarea name="notes" class="form-control">{{ appointment.notes if appointment else '' }}</textarea>
  </div>

  <button class="btn btn-primary">Save</button>
  <a href="{{ url_for('appointments_list') }}" class="btn btn-secondary">Cancel</a>
</form>
{% endblock %}